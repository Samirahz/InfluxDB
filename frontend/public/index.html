<!DOCTYPE html>
<html lang="en">

<head>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#000000">
  <meta name="description" content="Web app for InfluxDB No-Code Interface">
  <title>InfluxDB No-Code Interface</title>
</head>

<body class="dark-mode">
  <div id="root"></div>
</body>

<div class="container">

  <!-- Dashboard Tabs -->
  <div class="dashboard-tabs">
    <div class="dashboard-tab active">
      <span>1</span>
      <span>Dashboard</span>
      <span class="close-btn">X</span>
    </div>
    <div class="dashboard-tab">
      <span>2</span>
      <span>Dashboard</span>
      <span class="close-btn">X</span>
    </div>
    <div class="dashboard-tab">
      <span>3</span>
      <span>Dashboard</span>
      <span class="close-btn">X</span>
    </div>
    <div class="add-dashboard-btn">
      <span>+</span>
      <span>New Dashboard</span>
    </div>

    <div class="dashboard-actions">
      <button class="dashboard-action-btn">Save All</button>
      <button class="dashboard-action-btn">Settings</button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Query Builder Section -->
    <div class="query-section">
      <!-- Bucket & Measurement Selection -->
      <div class="card">
        <div class="card-title">
          Data Source
        </div>
        <div class="form-group">
          <!-- Dummy Data for Buckets and Measurements -->
          <label class="form-label">Bucket</label>
          <select class="form-control">
            <option value="" disabled selected>Select bucket</option>
            <option>Bucket 1</option>
            <option>Bucket 2</option>
            <option>Bucket 3</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Measurement</label>
          <select class="form-control">
            <option value="" disabled selected>Select measurement</option>
            <option>Measurement 1</option>
            <option>Measurement 2</option>
            <option>Measurement 3</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">Time Range</label>
          <div class="time-picker">
            <select class="form-control">
              <option value="" disabled selected>Select time range</option>
              <option>Last 1 hour</option>
              <option>Last 24 hours</option>
              <option>Last 7 days</option>
              <option>Custom range</option>
            </select>
            <select class="form-control">
              <option value="" disabled selected>Select interval</option>
              <option>5m intervals</option>
              <option>15m intervals</option>
              <option>1h intervals</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Combined Fields & Tags -->
      <div class="card">
        <div class="card-title">
          Available Fields & Tags
        </div>
        <div class="form-group">
          <input type="text" class="search-box" placeholder="Search fields and tags...">
        </div>
        <div class="available-fields">
          <!-- Dummy Data for tags and fields -->
          <div class="field-item" draggable="true">
            <span class="field-type tag">TAG</span>
            <span>location</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type tag">TAG</span>
            <span>sensor_id</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type">FIELD</span>
            <span>temperature</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type">FIELD</span>
            <span>humidity</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type tag">TAG</span>
            <span>building</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type">FIELD</span>
            <span>pressure</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type tag">TAG</span>
            <span>room</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type">FIELD</span>
            <span>battery_level</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type tag">TAG</span>
            <span>device_type</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type">FIELD</span>
            <span>signal_strength</span>
          </div>
          <div class="field-item" draggable="true">
            <span class="field-type">FIELD</span>
            <span>cpu_usage</span>
          </div>
        </div>
      </div>

      <!-- Selected Fields & Controls -->
      <div class="card">
        <div class="card-title">
          Query Builder
        </div>
        <div class="form-group">
          <label class="form-label">Selected Fields</label>
          <div class="drag-drop-area">
            <div>Drag fields here to build your query</div>
            <div class="selected-fields">
            </div>
          </div>
        </div>

        <div class="btn-group">
          <button class="btn btn-primary">Run Query</button>
          <button class="btn btn-secondary">Reset</button>
          <button class="btn btn-secondary">Save Query</button>
        </div>
      </div>

      <!-- Saved Queries -->
      <div class="card">
        <div class="card-title">
          <!-- Dummy Data for saved queries -->
          Saved Queries
        </div>
        <div class="form-group">
          <input type="text" class="search-box" placeholder="Search saved queries...">
        </div>
        <div class="folder-list">
          <li class="folder-item">
            <div class="folder-name">
              <span>Folder 1</span>
              <div class="query-actions">
                <button class="query-action-btn">Edit</button>
                <button class="query-action-btn">Delete</button>
              </div>
            </div>
            <ul class="sub-folder-list">
              <li class="sub-folder-item">
                <span>Query 1</span>
                <div class="query-actions">
                  <button class="query-action-btn">Load</button>
                  <button class="query-action-btn">Edit</button>
                </div>
              </li>
              <li class="sub-folder-item">
                <span>Query 2</span>
                <div class="query-actions">
                  <button class="query-action-btn">Load</button>
                  <button class="query-action-btn">Edit</button>
                </div>
              </li>
              <li class="sub-folder-item">
                <span>Query 3</span>
                <div class="query-actions">
                  <button class="query-action-btn">Load</button>
                  <button class="query-action-btn">Edit</button>
                </div>
              </li>
            </ul>
          </li>
          <li class="folder-item">
            <div class="folder-name">
              <span>Folder 2</span>
              <div class="query-actions">
                <button class="query-action-btn">Edit</button>
                <button class="query-action-btn">Delete</button>
              </div>
            </div>
            <ul class="sub-folder-list">
              <li class="sub-folder-item">
                <span>Query 1</span>
                <div class="query-actions">
                  <button class="query-action-btn">Load</button>
                  <button class="query-action-btn">Edit</button>
                </div>
              </li>
              <li class="sub-folder-item">
                <span>Query 2</span>
                <div class="query-actions">
                  <button class="query-action-btn">Load</button>
                  <button class="query-action-btn">Edit</button>
                </div>
              </li>
            </ul>
          </li>
          <li class="folder-item">
            <div class="folder-name">
              <span>Recent Queries</span>
              <div class="query-actions">
                <button class="query-action-btn">Clear</button>
              </div>
            </div>
            <ul class="sub-folder-list">
              <li class="sub-folder-item">
                <span>Query 1</span>
                <div class="query-actions">
                  <button class="query-action-btn">Load</button>
                  <button class="query-action-btn">Save</button>
                </div>
              </li>
              <li class="sub-folder-item">
                <span>Query 2</span>
                <div class="query-actions">
                  <button class="query-action-btn">Load</button>
                  <button class="query-action-btn">Save</button>
                </div>
              </li>
            </ul>
          </li>
        </div>
      </div>

    </div>
    <!-- Visualization Section -->
    <div class="visualization-section">
      <div class="card visualization-panel">
        <div>
          <div class="tabs">
            <div class="tab active">Chart View</div>
            <div class="tab">Table View</div>
          </div>

          <div class="chart-controls">
            <div class="chart-type-selector">
              <label class="form-label">Chart Type:</label>
              <select class="form-control" style="width: auto;">
                <option value="line">Line Chart</option>
                <option value="scatter">Scatter Plot</option>
                <option value="bar">Bar Chart</option>
                <option value="area">Area Chart</option>
                <option value="histogram">Histogram</option>
                <option value="heatmap">Heatmap</option>
              </select>
            </div>
            <div class="chart-options">
              <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;">Chart Options</button>
              <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;">Save Dashboard</button>
            </div>
          </div>
        </div>

        <div class="chart-container">
          <div class="chart-placeholder">
            ðŸ“ˆ Time Series Visualization - Full Width View
            <div>
              Data points: 1,247 | Last updated: 2 min ago
            </div>
          </div>
        </div>

        <div>
          <div class="flux-toggle-container">
            <div class="status-indicator">
              <!-- Dummy Connection status -->
              <div class="status-dot"></div>
              <span>Connected to InfluxDB</span>
            </div>
            <div style="display: flex; align-items: center; gap: 12px;">
              <!-- Flux Code Toggle -->
              <span style="font-size: 14px;">Show Flux Code</span>
              <label class="toggle-switch">
                <input type="checkbox" id="fluxToggle">
                <span class="toggle-slider"></span>
              </label>
              <!-- Dummy Data for query time -->
              <!-- Add id or class to dynamically change this output in the backend -->
              <span style="font-size: 12px;">Query executed in 127ms</span>
            </div>
          </div>

          <!-- Dummy Flux Output -->
          <div class="code-panel" id="fluxCodePanel" style="display: none;">
            <div class="code">
              <span class="syntax-keyword">from</span>(<span class="syntax-string">bucket:</span> <span
                class="syntax-string">"sensor-data"</span>)
              |> <span class="syntax-function">range</span>(<span class="syntax-string">start:</span> -1h)
              |> <span class="syntax-function">filter</span>(<span class="syntax-string">fn:</span> (r) =>
              r._measurement == <span class="syntax-string">"temperature"</span>)
              |> <span class="syntax-function">filter</span>(<span class="syntax-string">fn:</span> (r) => r._field ==
              <span class="syntax-string">"value"</span>)
              |> <span class="syntax-function">aggregateWindow</span>(<span class="syntax-string">every:</span> 5m,
              <span class="syntax-string">fn:</span> mean)
            </div>
          </div>

          <div class="btn-group" style="margin-top: 16px;">
            <button class="btn btn-primary">Export to Grafana</button>
            <button class="btn btn-secondary">Copy Flux Code</button>
          </div>
        </div>
      </div>
    </div>
  </div>
  </body>

</html>
<script>
  document.querySelectorAll('.field-item').forEach(item => {
    item.addEventListener('dragstart', e => {
      e.dataTransfer.setData('text/plain', item.innerText.trim());
    });
  });

  const dropArea = document.querySelector('.drag-drop-area');
  const selectedFieldsContainer = document.querySelector('.selected-fields');

  // Handle drag over and drop
  dropArea.addEventListener('dragover', e => {
    e.preventDefault();
    dropArea.classList.add('drag-over');
  });
  dropArea.addEventListener('dragleave', () => {
    dropArea.classList.remove('drag-over');
  });
  dropArea.addEventListener('drop', e => {
    e.preventDefault();
    dropArea.classList.remove('drag-over');
    const fieldName = e.dataTransfer.getData('text/plain');

    // new selected field element
    const newField = document.createElement('div');
    newField.className = 'selected-field';
    newField.innerHTML = `
    <span>${fieldName}</span>
    <span class="remove-field">X</span>
  `;

    // Append and attach removal handler
    selectedFieldsContainer.appendChild(newField);
    attachRemoveHandler(newField.querySelector('.remove-field'));
  });

  // attach removal handler to any remove buttons
  function attachRemoveHandler(btn) {
    btn.addEventListener('click', () => {
      btn.parentElement.remove();
    });
  }

  // removal handler to any existing fields already in the HTML
  document.querySelectorAll('.remove-field').forEach(btn => {
    attachRemoveHandler(btn);
  });

  // Toggle option for the Flux Code
  const fluxToggle = document.getElementById('fluxToggle');
  const fluxCodePanel = document.getElementById('fluxCodePanel');

  if (fluxToggle && fluxCodePanel) {
    fluxToggle.addEventListener('change', function () {
      if (fluxToggle.checked) {
        fluxCodePanel.style.display = 'block';
      } else {
        fluxCodePanel.style.display = 'none';
      }
    });
  }
</script>